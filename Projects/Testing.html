<!DOCTYPE html>
<HTML>
  <HEAD>
    <TITLE>Michael Cummins Compiler Project</TITLE>
    <LINK rel="stylesheet" type="text/css" href="myStyle.css" />
	<script type = text/javascript>
        
        var tokens = [];
        var tokenIndex = 0;
        var currentToken = "";
        var numErrors = 0;
        var EOF = "$";
        var currentProgram = 0;
        var completedPrograms = 0;

        
        function init(){
            document.getElementById("CompiledCodeOutput").value = "";
            tokens = [];
            tokenIndex = 0;
            currentToken = ' ';
            numErrors = 0;
            EOF = "$";
            currentProgram = 0;
            completedPrograms = 0;
        }
        
        function createTokens(){
            var code = document.getElementById("SourceCodeInput").value;
            return code;
        }
        
        
        
        function clickTheButton(){
            init();
            parse();
        }
        function trim(str){
            return str.replace(/\s/g, "");
        }
        
        function getSourceCode(){
            var sourceCode = document.getElementById("SourceCodeInput").value;
            return sourceCode;
        }
        
        function parse(){
        //    currentToken = getNextToken();
            newLex(getSourceCode());
            outputMessage("Parsing found " + numErrors + " error(s).");
        }
        
        function newLex(userInput){
            var lines = userInput.toString().split("\n");
            var line;
            //var character;
            var currentTokenTwo;
            
            for(var currentLine = 0; currentLine < lines.length; currentLine++){
                
                line = lines[currentLine];
                
                for(var column = 0; column < line.length; column++){
                    
                    if(currentProgram != completedPrograms){
                        outputMessage("Lexing program " + currentProgram + "...");
                        completedPrograms++;
                    }
                    
                    currentTokenTwo = line[column];
                    
                    if(currentTokenTwo == "p"){
                        if(line[column + 1] == "r" && line[column + 2] == "i" 
                           && line[column + 3 ] == "n" && line[column + 4] == "t"){
                            addToken("Print", "print", currentLine, column);
                            column += 4;
                            continue;
                        }else{
                            addToken("ID", "p", currentLine, column);
                            continue;
                        }
                    }
                    
                    if(currentTokenTwo == "i"){
                        if(line[column + 1] == "n" && line[column + 2] == "t"){
                            addToken("INT", "int", currentLine, column);
                            column += 2;
                            continue;
                        }else if(line[column + 1] == "f"){
                            addToken("If", "if", currentLine, column);
                            column += 1;
                            continue;
                        }else{
                            addToken("Id", "i", currentLine, column);
                            continue;
                        }
                    }
                    if(currentTokenTwo == "b"){
                        if(line[column + 1] == "o" && line[column + 2] == "o" && line[column + 3] == "l"
                          && line[column + 4] == "e" && line[column + 5] == "a" && line[column + 6] == "n"){
                            addToken("Boolean", "boolean", currentLine, column);
                            continue;
                            column += 6;
                        }else{
                            addToken("Id", "b", currentLine, column);
                            continue;
                        }
                    }
                    if(currentTokenTwo == "f"){
                        if(line[column + 1] == "a" && line[column + 2] == "l" 
                           && line[column + 3] == "s" && line[column + 4] == "e"){
                            addToken("False", "false", currentLine, column);
                            column += 4;
                            continue;
                        }else{
                            addToken("Id", "f", currentLine, column);
                            continue;
                        }
                    }
                    if(currentTokenTwo == "{"){
                        addToken("L_Bracket", "{", currentLine, column);
                        continue;
                    }
                    if(currentTokenTwo == "}"){
                        addToken("R_Bracket", "}", currentLine, column);
                        continue;
                    }
                    if(currentTokenTwo == "("){
                        addToken("L_Paren", "(", currentLine, column);
                        continue;
                    }
                    if(currentTokenTwo == ")"){
                        addToken("R_Paren",")", currentLine, column);
                        continue;
                    }
                    if(currentTokenTwo >= "0" && currentTokenTwo <= "9"){
                        addToken("Digit", currentTokenTwo, currentLine, column);
                        continue;
                    }
                    if(currentTokenTwo == EOF){
                        currentProgram++;
                    }
                    if(currentTokenTwo == "!"){
                        if(line[column + 1]== "="){
                            addToken("Not_Equal", "!=", currentLine, column);
                            column++;
                            continue;
                        }else{
                            addToken("Factorial", "!", currentLine, column);
                            continue;
                        }
                    }
                    if(currentTokenTwo == "t"){
                        if(line[column + 1] == "r" && line[column + 2] == "u" && line[column + 3] == "e"){
                            addToken("Boolean", "True", currentLine, column);
                            column += 3;
                            continue;
                        }else{
                        addToken("id", "t", currentLine, column);
                        continue;
                        }
                    }
                    if(currentTokenTwo == " "){
                        continue;
                    }
                    if(currentTokenTwo == "/n"){
                        line++;
                        continue;
                    }
                    if(currentTokenTwo == "/t"){
                        column += 8;
                        continue;
                    }
                    if(currentTokenTwo == "\""){
                       addToken("\"", "\"", currentLine, column);
                        continue;
                    }
                    if(currentTokenTwo == "'"){
                        addToken("'", "'", currentLine, column);
                        continue;
                    }
                    if(currentTokenTwo == "="){
                        if(line[column + 1] == "="){
                            addToken("OP_Equality", "==", currentLine, column);
                            column++;
                            continue;
                        }else{
                            addToken("OP_Assignment", "=", currentLine, column);
                        }
                    }
                    if(currentTokenTwo == "+"){
                        addToken("intop", "+", currentLine, column);
                    }
                    if(currentTokenTwo == "$"){
                        addToken("EOF", "$", currentLine, column);
                        outputMessage("\n");
                        currentProgram++;
                        continue;
                    }
                }
            }
        }
        
        function Token(kind, value, line, column){
            this.kind = kind;
            this.value = value;
            this.line = line;
            this.column = column;
        }
        function addToken(kind, value, line, column){
            var tempToken = new Token(kind, value, line, column);
            outputMessage("DEBUG Lexer - " + kind + "[ " + value + " ] found at " + line + "," + column);
            tokens.push(tempToken);
        }

        
        function outputMessage(message){
            document.getElementById("CompiledCodeOutput").value += message + "\n";
        }
        
        function getNextToken(){
            var thisToken = EOF;
            if (tokenIndex < tokens.length){
                thisToken = tokens[tokenIndex];
                tokenIndex++;
            }
            return thisToken;
        }
        
        
  
         
        
	</script>
  </HEAD>
  <BODY onload = "init();">
    <h1>Cummins Compiler</h1>
    <DIV class="center">
    <TEXTAREA id="SourceCodeInput" rows="30" cols="50"></TEXTAREA>  
    <TEXTAREA id="CompiledCodeOutput" rows="30" cols="50" readonly></TEXTAREA></br>
	<INPUT type="button" id="CompileThis" value="Compile Code" onclick="clickTheButton();" />
	</DIV>
  </BODY>
</HTML>

